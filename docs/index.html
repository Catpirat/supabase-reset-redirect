<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Procesando reset password...</title>
    <script>
      window.onload = () => {
        // Obtener par치metros de query (?...) y hash (#...)
        const queryParams = new URLSearchParams(window.location.search);
        const hashParams = new URLSearchParams(window.location.hash.substring(1));

        // Revisar ambos lugares
        const accessToken = queryParams.get("access_token") || hashParams.get("access_token") || queryParams.get("token") || hashParams.get("token");
        const type = queryParams.get("type") || hashParams.get("type");
        const redirectTo = "caparazonemocional://reset-password";

        if (type === "recovery" && accessToken) {
          const deepLink = redirectTo + "#access_token=" + accessToken;
          console.log("Redirigiendo a:", deepLink);
          window.location.href = deepLink;
        } else {
          document.body.innerHTML = "<h2>Error: token inv치lido o falta par치metro</h2><p>Params recibidos:<br>" 
            + "Query: " + window.location.search + "<br>"
            + "Hash: " + window.location.hash + "</p>";
        }
      };
    </script>

  </head>
  <body>
    <h2>Procesando redirecci칩n...</h2>
    <p>Si no pasa nada, abre la app manualmente.</p>
  </body>
</html>
