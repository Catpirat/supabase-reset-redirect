<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Procesando reset password...</title>
    <script>
      window.onload = () => {
        // Extraemos todo lo que venga después del "#"
        const hashParams = new URLSearchParams(window.location.hash.substring(1));
        const accessToken = hashParams.get("access_token");
        const type = hashParams.get("type");
        const redirectTo = "caparazonemocional://reset-password";

        if (type === "recovery" && accessToken) {
          const deepLink = redirectTo + "#access_token=" + accessToken;
          console.log("Redirigiendo a:", deepLink);
          window.location.href = deepLink;
        } else {
          document.body.innerHTML = "<h2>Error: token inválido o falta parámetro</h2>";
        }
      };
    </script>

  </head>
  <body>
    <h2>Procesando redirección...</h2>
    <p>Si no pasa nada, abre la app manualmente.</p>
  </body>
</html>
